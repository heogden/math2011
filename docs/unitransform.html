<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Univariate transformations | MATH2011: Statistical Distribution Theory</title>
  <meta name="description" content="The course notes for MATH2011: Statistical Distribution Theory." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Univariate transformations | MATH2011: Statistical Distribution Theory" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The course notes for MATH2011: Statistical Distribution Theory." />
  <meta name="github-repo" content="heogden/math2011" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Univariate transformations | MATH2011: Statistical Distribution Theory" />
  
  <meta name="twitter:description" content="The course notes for MATH2011: Statistical Distribution Theory." />
  

<meta name="author" content="Dr Helen Ogden" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gamma.html">
<link rel="next" href="bivariate-distributions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MATH2011: Statistical Distribution Theory</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Distributions and their properties</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Probability distributions</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#random-variables"><i class="fa fa-check"></i><b>1.1</b> Random variables</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#examples-of-discrete-distributions"><i class="fa fa-check"></i><b>1.2</b> Examples of discrete distributions</a><ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#the-bernoulli-distribution"><i class="fa fa-check"></i><b>1.2.1</b> The Bernoulli distribution</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#the-binomial-distribution"><i class="fa fa-check"></i><b>1.2.2</b> The binomial distribution</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#the-negative-binomial-distribution"><i class="fa fa-check"></i><b>1.2.3</b> The negative binomial distribution</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#poisson"><i class="fa fa-check"></i><b>1.2.4</b> The Poisson distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#examples-of-continuous-distributions"><i class="fa fa-check"></i><b>1.3</b> Examples of continuous distributions</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#the-exponential-distribution"><i class="fa fa-check"></i><b>1.3.1</b> The exponential distribution</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#the-uniform-distribution"><i class="fa fa-check"></i><b>1.3.2</b> The uniform distribution</a></li>
<li class="chapter" data-level="1.3.3" data-path="index.html"><a href="index.html#the-normal-distribution"><i class="fa fa-check"></i><b>1.3.3</b> The normal distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="moments.html"><a href="moments.html"><i class="fa fa-check"></i><b>2</b> Moments</a><ul>
<li class="chapter" data-level="2.1" data-path="moments.html"><a href="moments.html#expected-value"><i class="fa fa-check"></i><b>2.1</b> Expected value</a></li>
<li class="chapter" data-level="2.2" data-path="moments.html"><a href="moments.html#variance"><i class="fa fa-check"></i><b>2.2</b> Variance</a></li>
<li class="chapter" data-level="2.3" data-path="moments.html"><a href="moments.html#higher-order-moments"><i class="fa fa-check"></i><b>2.3</b> Higher-order moments</a></li>
<li class="chapter" data-level="2.4" data-path="moments.html"><a href="moments.html#standardised-moments"><i class="fa fa-check"></i><b>2.4</b> Standardised moments</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="genfuns.html"><a href="genfuns.html"><i class="fa fa-check"></i><b>3</b> Generating functions</a><ul>
<li class="chapter" data-level="3.1" data-path="genfuns.html"><a href="genfuns.html#the-moment-generating-function"><i class="fa fa-check"></i><b>3.1</b> The moment generating function</a></li>
<li class="chapter" data-level="3.2" data-path="genfuns.html"><a href="genfuns.html#the-cumulant-generating-function"><i class="fa fa-check"></i><b>3.2</b> The cumulant generating function</a></li>
<li class="chapter" data-level="3.3" data-path="genfuns.html"><a href="genfuns.html#generating-functions-under-linear-transformation"><i class="fa fa-check"></i><b>3.3</b> Generating functions under linear transformation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sums-of-random-variables.html"><a href="sums-of-random-variables.html"><i class="fa fa-check"></i><b>4</b> Sums of random variables</a><ul>
<li class="chapter" data-level="4.1" data-path="sums-of-random-variables.html"><a href="sums-of-random-variables.html#generating-functions-of-a-sum"><i class="fa fa-check"></i><b>4.1</b> Generating functions of a sum</a></li>
<li class="chapter" data-level="4.2" data-path="sums-of-random-variables.html"><a href="sums-of-random-variables.html#closure-results-for-some-standard-distributions"><i class="fa fa-check"></i><b>4.2</b> Closure results for some standard distributions</a></li>
<li class="chapter" data-level="4.3" data-path="sums-of-random-variables.html"><a href="sums-of-random-variables.html#properties-of-the-sample-mean-of-normal-observations"><i class="fa fa-check"></i><b>4.3</b> Properties of the sample mean of normal observations</a></li>
<li class="chapter" data-level="4.4" data-path="sums-of-random-variables.html"><a href="sums-of-random-variables.html#clt"><i class="fa fa-check"></i><b>4.4</b> The central limit theorem</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html"><i class="fa fa-check"></i><b>5</b> Maxima and minima</a><ul>
<li class="chapter" data-level="5.1" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html#order-statistics"><i class="fa fa-check"></i><b>5.1</b> Order Statistics</a></li>
<li class="chapter" data-level="5.2" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html#the-cdf-of-y_n-the-largest-value-in-a-random-sample-of-size-n"><i class="fa fa-check"></i><b>5.2</b> The cdf of <span class="math inline">\(Y_{(n)}\)</span>, the largest value in a random sample of size <span class="math inline">\(n\)</span></a></li>
<li class="chapter" data-level="5.3" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html#the-pdf-of-the-maximum-in-the-continuous-case"><i class="fa fa-check"></i><b>5.3</b> The pdf of the maximum in the continuous case</a></li>
<li class="chapter" data-level="5.4" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html#the-cdf-of-y_1-the-smallest-value-in-a-random-sample-of-size-n"><i class="fa fa-check"></i><b>5.4</b> The cdf of <span class="math inline">\(Y_{(1)}\)</span>, the smallest value in a random sample of size <span class="math inline">\(n\)</span></a></li>
<li class="chapter" data-level="5.5" data-path="maxima-and-minima.html"><a href="maxima-and-minima.html#the-pdf-of-the-minimum-in-the-continuous-case"><i class="fa fa-check"></i><b>5.5</b> The pdf of the minimum in the continuous case</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gamma.html"><a href="gamma.html"><i class="fa fa-check"></i><b>6</b> The gamma distribution</a><ul>
<li class="chapter" data-level="6.1" data-path="gamma.html"><a href="gamma.html#the-gamma-distribution"><i class="fa fa-check"></i><b>6.1</b> The gamma distribution</a></li>
<li class="chapter" data-level="6.2" data-path="gamma.html"><a href="gamma.html#properties-of-the-gamma-distribution"><i class="fa fa-check"></i><b>6.2</b> Properties of the gamma distribution</a></li>
<li class="chapter" data-level="6.3" data-path="gamma.html"><a href="gamma.html#chisquared"><i class="fa fa-check"></i><b>6.3</b> The chi-squared distribution</a></li>
<li class="chapter" data-level="6.4" data-path="gamma.html"><a href="gamma.html#distribution-of-the-sample-variance"><i class="fa fa-check"></i><b>6.4</b> Distribution of the sample variance</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="unitransform.html"><a href="unitransform.html"><i class="fa fa-check"></i><b>7</b> Univariate transformations</a><ul>
<li class="chapter" data-level="7.1" data-path="unitransform.html"><a href="unitransform.html#transformed-random-variables"><i class="fa fa-check"></i><b>7.1</b> Transformed random variables</a></li>
<li class="chapter" data-level="7.2" data-path="unitransform.html"><a href="unitransform.html#one-to-one-transformations-of-continuous-random-variables"><i class="fa fa-check"></i><b>7.2</b> One-to-one transformations of continuous random variables</a></li>
<li class="chapter" data-level="7.3" data-path="unitransform.html"><a href="unitransform.html#generating-samples-from-any-distribution"><i class="fa fa-check"></i><b>7.3</b> Generating samples from any distribution</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html"><i class="fa fa-check"></i><b>8</b> Bivariate distributions</a><ul>
<li class="chapter" data-level="8.1" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html#joint-distributions"><i class="fa fa-check"></i><b>8.1</b> Joint distributions</a></li>
<li class="chapter" data-level="8.2" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html#moments-of-jointly-distributed-random-variables"><i class="fa fa-check"></i><b>8.2</b> Moments of jointly distributed random variables</a></li>
<li class="chapter" data-level="8.3" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html#the-bivariate-normal-distribution"><i class="fa fa-check"></i><b>8.3</b> The bivariate normal distribution</a></li>
<li class="chapter" data-level="8.4" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html#bivariate-moment-generating-functions"><i class="fa fa-check"></i><b>8.4</b> Bivariate moment generating functions</a></li>
<li class="chapter" data-level="8.5" data-path="bivariate-distributions.html"><a href="bivariate-distributions.html#a-useful-property-of-covariances"><i class="fa fa-check"></i><b>8.5</b> A useful property of covariances</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html"><i class="fa fa-check"></i><b>9</b> Bivariate transformations</a><ul>
<li class="chapter" data-level="9.1" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html#the-transformation-theorem"><i class="fa fa-check"></i><b>9.1</b> The transformation theorem</a></li>
<li class="chapter" data-level="9.2" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html#the-beta-distribution"><i class="fa fa-check"></i><b>9.2</b> The beta distribution</a></li>
<li class="chapter" data-level="9.3" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html#the-cauchy-distribution"><i class="fa fa-check"></i><b>9.3</b> The Cauchy distribution</a></li>
<li class="chapter" data-level="9.4" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html#the-t-distribution"><i class="fa fa-check"></i><b>9.4</b> The <span class="math inline">\(t\)</span> distribution</a></li>
<li class="chapter" data-level="9.5" data-path="bivariate-transformations.html"><a href="bivariate-transformations.html#the-f-distribution"><i class="fa fa-check"></i><b>9.5</b> The <span class="math inline">\(F\)</span> distribution</a></li>
</ul></li>
<li class="part"><span><b>II Statistical inference</b></span></li>
<li class="chapter" data-level="10" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>10</b> Parameter estimation</a><ul>
<li class="chapter" data-level="10.1" data-path="estimation.html"><a href="estimation.html#estimators-and-estimates"><i class="fa fa-check"></i><b>10.1</b> Estimators and estimates</a></li>
<li class="chapter" data-level="10.2" data-path="estimation.html"><a href="estimation.html#bias"><i class="fa fa-check"></i><b>10.2</b> Bias</a></li>
<li class="chapter" data-level="10.3" data-path="estimation.html"><a href="estimation.html#consistency"><i class="fa fa-check"></i><b>10.3</b> Consistency</a></li>
<li class="chapter" data-level="10.4" data-path="estimation.html"><a href="estimation.html#mean-squared-error"><i class="fa fa-check"></i><b>10.4</b> Mean squared error</a></li>
<li class="chapter" data-level="10.5" data-path="estimation.html"><a href="estimation.html#method-of-moments-estimation"><i class="fa fa-check"></i><b>10.5</b> Method of moments estimation</a></li>
<li class="chapter" data-level="10.6" data-path="estimation.html"><a href="estimation.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>10.6</b> Maximum likelihood estimation</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>11</b> Confidence intervals and hypothesis testing</a><ul>
<li class="chapter" data-level="11.1" data-path="inference.html"><a href="inference.html#expressing-uncertainty-in-parameter-estimates"><i class="fa fa-check"></i><b>11.1</b> Expressing uncertainty in parameter estimates</a></li>
<li class="chapter" data-level="11.2" data-path="inference.html"><a href="inference.html#confidence-intervals"><i class="fa fa-check"></i><b>11.2</b> Confidence intervals</a></li>
<li class="chapter" data-level="11.3" data-path="inference.html"><a href="inference.html#hypothesis-testing"><i class="fa fa-check"></i><b>11.3</b> Hypothesis testing</a></li>
<li class="chapter" data-level="11.4" data-path="inference.html"><a href="inference.html#two-sample-hypothesis-testing"><i class="fa fa-check"></i><b>11.4</b> Two-sample hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>12</b> Bayesian inference</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian.html"><a href="bayesian.html#frequentist-and-bayesian-inference"><i class="fa fa-check"></i><b>12.1</b> Frequentist and Bayesian inference</a></li>
<li class="chapter" data-level="12.2" data-path="bayesian.html"><a href="bayesian.html#prior-and-posterior-distributions"><i class="fa fa-check"></i><b>12.2</b> Prior and posterior distributions</a></li>
<li class="chapter" data-level="12.3" data-path="bayesian.html"><a href="bayesian.html#the-posterior-predictive-distribution"><i class="fa fa-check"></i><b>12.3</b> The posterior predictive distribution</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MATH2011: Statistical Distribution Theory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\(
\newcommand{\bm}[1]{\boldsymbol{\mathbf{#1}}}
\)
<div id="unitransform" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Univariate transformations</h1>
<div id="transformed-random-variables" class="section level2">
<h2><span class="header-section-number">7.1</span> Transformed random variables</h2>
<p>In this chapter, starting with a random variable <span class="math inline">\(Y\)</span>, we define a new random variable <span class="math inline">\(U = U(Y)\)</span>. We want to be able to determine the distribution of the transformed random variable <span class="math inline">\(U\)</span>.</p>
<p>We have already studied one method for finding the distribution of a transformed random variable, when that transformation is linear (<span class="math inline">\(U = a + bY\)</span> for suitable constants <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>). In that case, if we have the moment generating function of <span class="math inline">\(Y\)</span>, we can use Theorem <a href="genfuns.html#thm:gflinear">3.2</a> to find the moment generating function of <span class="math inline">\(U\)</span>.</p>
<p>However, we are often interested in non-linear transformations. For example, we have seen (in Proposition <a href="gamma.html#prp:chisquarednormal">6.6</a>) an example where we squared a <span class="math inline">\(N(0, 1)\)</span> random variables to obtain a new random variable with <span class="math inline">\(\chi^2_1\)</span> distribution, i.e.Â we had a transformation of the form <span class="math inline">\(U = Y^2\)</span>.</p>
<p>We begin with two simple examples.</p>

<div class="example">
<p><span id="exm:trans1" class="example"><strong>Example 7.1  </strong></span>Suppose <span class="math inline">\(Y\)</span> has pdf <span class="math display">\[f(y) = 2y, \quad \text{for $0 &lt; y &lt; 1$}.\]</span> Let <span class="math inline">\(U = Y^2\)</span>. What is the distribution of <span class="math inline">\(U\)</span>?</p>
Let <span class="math inline">\(G(.)\)</span> and <span class="math inline">\(g(.)\)</span> be the cdf and pdf of <span class="math inline">\(U\)</span>. We have <span class="math display">\[G(u) = P(U \leq u) = P(Y^2 \leq u) 
= P(Y \leq \sqrt{u}) = F(\sqrt{u}).\]</span> So
<span class="math display">\[\begin{align*}
g(u) &amp;= \frac{dG(u)}{du} = \frac{dF(\sqrt{u})}{du} 
= f(\sqrt{u}) \frac{1}{2 \sqrt{u}} \\
&amp;= 2 \sqrt{u} \frac{1}{2 \sqrt{u}} 
= 1 \quad \text{for $0 &lt; u &lt; 1$,}
\end{align*}\]</span>
which is the pdf of a <span class="math inline">\(U(0, 1)\)</span> distribution. So <span class="math inline">\(U \sim U(0, 1)\)</span>.
</div>


<div class="example">
<p><span id="exm:trans2" class="example"><strong>Example 7.2  </strong></span>Suppose <span class="math inline">\(Y \sim U(0, 1)\)</span>. Let <span class="math inline">\(U = -\log{Y}\)</span>. What is the distribution of <span class="math inline">\(U\)</span>?</p>
Let <span class="math inline">\(G(.)\)</span> and <span class="math inline">\(g(.)\)</span> be the cdf and pdf of <span class="math inline">\(U\)</span>. We have
<span class="math display">\[\begin{align*}
G(u) &amp;= P(U \leq u) = P(\log Y \leq u) \\
&amp;= P(\log Y \geq -u) = P(Y \geq e^{-u}) \\
&amp;= 1 - P(Y &lt; e^{-u}) = 1 - F(e^{-u}) \\
&amp;= 1 - e^{-u}, \quad \text{for $0 &lt; u &lt; \infty$.}
\end{align*}\]</span>
So <span class="math display">\[g(u) = \frac{dG(u)}{du} = e^{-u}, \quad \text{for $u &gt; 0$},\]</span> which we recognise as the pdf of an exponential distribution with rate parameter <span class="math inline">\(1\)</span>, so <span class="math inline">\(U \sim \text{exponential}(1)\)</span>.
</div>

</div>
<div id="one-to-one-transformations-of-continuous-random-variables" class="section level2">
<h2><span class="header-section-number">7.2</span> One-to-one transformations of continuous random variables</h2>

<div class="theorem">
<span id="thm:unitrans" class="theorem"><strong>Theorem 7.1  </strong></span>If <span class="math inline">\(U\)</span> is a one-to-one transformation of a continuous random variable <span class="math inline">\(Y\)</span>, the pdf of <span class="math inline">\(U\)</span> is <span class="math display">\[g(u) = f(w(u)) \left|\frac{dy}{du} \right|\]</span> where Y = w(U) is the inverse transformation.
</div>
 
<div class="remark">
 <span class="remark"><em>Remark. </em></span> In Example <a href="unitransform.html#exm:trans1">7.1</a>, <span class="math inline">\(U = Y^2\)</span>, so the inverse transformation is <span class="math inline">\(Y = U^{1/2} = w(U)\)</span>. In Example <a href="unitransform.html#exm:trans2">7.2</a>, <span class="math inline">\(U = -\log Y\)</span>, so the inverse transformation is <span class="math inline">\(Y = \exp(-U) = w(U)\)</span>.
</div>
 
<div class="remark">
 <span class="remark"><em>Remark. </em></span> If the domain of <span class="math inline">\(Y\)</span> is <span class="math inline">\((a, b)\)</span>, then the domain of <span class="math inline">\(U\)</span> is all values of <span class="math inline">\(u\)</span> such that <span class="math inline">\(a &lt; w(u) &lt; b\)</span> (where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> might be infinite).
</div>
 
<div class="proof">
<p> <span class="proof"><em>Proof</em> (Theorem <a href="unitransform.html#thm:unitrans">7.1</a>). </span> Let <span class="math inline">\(F(.)\)</span> and <span class="math inline">\(f(.)\)</span> be the cdf and pdf of <span class="math inline">\(Y\)</span>, and let <span class="math inline">\(G(.)\)</span> and <span class="math inline">\(g(.)\)</span> be the cdf and pdf of <span class="math inline">\(U\)</span>. Suppose <span class="math inline">\(U = h(Y)\)</span> is a one-to-one function with inverse <span class="math inline">\(Y = w(U)\)</span>. Since <span class="math inline">\(h(.)\)</span> is one-to-one, we may conclude that is is either an increasing or a decreasing function, and we split the proof into two cases.</p>
<p><strong>Case 1</strong>: <span class="math inline">\(h(.)\)</span> is an increasing function. Then <span class="math display">\[G(u) = P(U \leq u) = P(h(Y) \leq u) 
= P(Y \leq w(u)),\]</span> since <span class="math inline">\(h(.)\)</span> is increasing. So <span class="math inline">\(G(u) = F(w(u))\)</span>, and <span class="math display">\[g(u) = f\left(w(u)\right) \frac{dw(u)}{du}
= f\left(w(u)\right) \frac{dy}{du}
= f\left(w(u)\right) \left|\frac{dy}{du}\right|,\]</span> since <span class="math inline">\(\frac{dy}{du} &gt; 0\)</span>.</p>
<strong>Case 2</strong>: <span class="math inline">\(h(.)\)</span> is a decreasing function. Then <span class="math display">\[G(u) = P(U \leq u) = P(h(Y) \leq u) 
= P(Y \geq w(u)),\]</span> since <span class="math inline">\(h(.)\)</span> is decreasing. So <span class="math inline">\(G(u) = 1 - F(w(u))\)</span>, and <span class="math display">\[g(u) = - f\left(w(u)\right) \frac{dw(u)}{du}
= f\left(w(u)\right) \left(- \frac{dy}{du}\right)
= f\left(w(u)\right) \left|\frac{dy}{du}\right|,\]</span> since <span class="math inline">\(\frac{dy}{du} &lt; 0\)</span>.
</div>


<div class="example">
<p><span id="exm:unnamed-chunk-58" class="example"><strong>Example 7.3  (Kinetic energy of gas molecules)  </strong></span>Gas molecules move about with varying velocity which has, according to the Maxwell-Boltzmann law, a pdf given by <span class="math display">\[f(v) = c v^2 e^{-\beta v^2}, \quad v &gt; 0,\]</span> where <span class="math inline">\(c\)</span> is a constant to ensure the pdf integrates to <span class="math inline">\(1\)</span>. The kinetic energy is given by <span class="math inline">\(U = \frac{1}{2} m V^2\)</span>, where <span class="math inline">\(m\)</span> is the mass of the molecule. What is the pdf of <span class="math inline">\(U\)</span>, the kinetic energy of the molecule?</p>
<p>The domain of <span class="math inline">\(U\)</span> is <span class="math inline">\(0 &lt; u &lt; \infty\)</span>. For <span class="math inline">\(v &gt; 0\)</span>, <span class="math inline">\(h(v) = \frac{1}{2} m v^2\)</span> is a one-to-one function, as it is increasing with <span class="math inline">\(v\)</span>. So we may apply Theorem <a href="unitransform.html#thm:unitrans">7.1</a> to find the pdf <span class="math inline">\(g(.)\)</span> of <span class="math inline">\(U\)</span>.</p>
We have <span class="math inline">\(u = \frac{1}{2} m v^2\)</span>, so the inverse transformation is <span class="math inline">\(v = \sqrt{\frac{2u}{m}}\)</span>, and <span class="math display">\[\frac{dv}{du} = \frac{\sqrt{2}}{2 \sqrt{um}} = \frac{1}{\sqrt{2 u m}} &gt; 0
\quad \text{for $u &gt; 0$}.\]</span> So <span class="math inline">\(U\)</span> has pdf
<span class="math display">\[\begin{align*}
g(u) &amp;= f \left(\sqrt{\frac{2u}{m}} \right) \frac{1}{\sqrt{2um}} \\
&amp;= c \cdot \frac{2u}{m} e^{-\beta\frac{2u}{m}} \frac{1}{\sqrt{2um}} \\
&amp;= c \sqrt{2u} m^{-\frac{3}{2}}e^{-\beta\frac{2u}{m}}
\quad \text{for $u &gt; 0$.}
\end{align*}\]</span>
We see that <span class="math display">\[g(u) \propto u^{\frac{1}{2}} e^{-\beta\frac{2u}{m}} 
= u^{\frac{3}{2} - 1} e^{-\theta u}\]</span> with <span class="math inline">\(\theta = 2\beta / m\)</span>. So, by comparison with Equation <a href="gamma.html#eq:gamma">(6.1)</a>, <span class="math inline">\(U \sim \text{gamma}(3/2, 2 \beta/m)\)</span>.
</div>

</div>
<div id="generating-samples-from-any-distribution" class="section level2">
<h2><span class="header-section-number">7.3</span> Generating samples from any distribution</h2>

<div class="proposition">
<span id="prp:cdfconttrans" class="proposition"><strong>Proposition 7.1  </strong></span>Suppose that <span class="math inline">\(Y\)</span> is a continuous random variable with cumulative distribution function <span class="math inline">\(F(.)\)</span>. Let <span class="math inline">\(U = F(Y)\)</span>. Then <span class="math inline">\(U \sim U(0, 1)\)</span>.
</div>
 
<div class="proof">
 <span class="proof"><em>Proof. </em></span> <span class="math inline">\(U\)</span> has cdf
<span class="math display">\[\begin{align*}
G(u) &amp;= P(U \leq u) = P(F(Y) \leq u) \\
&amp;= P(Y \leq F^{-1}(u)) \quad \text{since $F(.)$ is increasing} \\
&amp;= F\left(F^{-1}(u)\right) = u \quad \text{for $0 &lt; u &lt; 1$},
\end{align*}\]</span>
which is the cdf of a <span class="math inline">\(U(0, 1)\)</span> distribution. So <span class="math inline">\(U \sim U(0, 1)\)</span>, as required.
</div>

<p>An immediate corollary of Proposition <a href="unitransform.html#prp:cdfconttrans">7.1</a> allows us to use a sample from a <span class="math inline">\(U(0, 1)\)</span> distribution to generate a sample from any other continuous distribution:</p>

<div class="corollary">
<span id="cor:inversetranscont" class="corollary"><strong>Corollary 7.1  </strong></span>Let <span class="math inline">\(F(.)\)</span> be the cumulative distribution function of a continuous distribution, with inverse <span class="math inline">\(F^{-1}(.)\)</span>. Suppose that <span class="math inline">\(U \sim U(0, 1)\)</span>. Then <span class="math inline">\(Y = F^{-1}(U)\)</span> has cumulative distribution function <span class="math inline">\(F(.)\)</span>.
</div>


<div class="example">
<span id="exm:unnamed-chunk-60" class="example"><strong>Example 7.4  </strong></span>Suppose that you are given <span class="math inline">\(U \sim N(0, 1)\)</span>, and would like to generate <span class="math inline">\(Y \sim \text{exponential}(2)\)</span>. The <span class="math inline">\(\text{exponential}(2)\)</span> distribution has cdf <span class="math display">\[F(y) = 1 - e^{-2y}, \quad \text{for $y &gt; 0$,}\]</span> and inverting (solving <span class="math inline">\(u = F(y)\)</span> for <span class="math inline">\(y\)</span>) gives <span class="math display">\[F^{-1}(u) = -\frac{1}{2} \log(1 - u).\]</span> So <span class="math display">\[Y = -\frac{1}{2} \log(1 - u) \sim \text{exponential}(2).\]</span>
</div>

<p>In fact, we can use the same method to find samples from a discrete distribution. To do this, we first need to define what we mean by <span class="math inline">\(F^{-1}(.)\)</span>, as the cdf <span class="math inline">\(F(.)\)</span> is constant between points in the domain, and so is not an invertible function.</p>
<p>For instance, if <span class="math inline">\(Y \sim \text{binomial}(2, 0.5)\)</span>, then we can plot the cdf of <span class="math inline">\(Y\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">pbinom</span>(x, <span class="dv">2</span>, <span class="fl">0.5</span>), <span class="dt">from =</span> <span class="dv">-1</span>, <span class="dt">to =</span> <span class="dv">3</span>,
      <span class="dt">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;cdf F(y)&quot;</span>, <span class="dt">n =</span> <span class="dv">1001</span>)</code></pre></div>
<p><img src="MATH2011_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<p>In this example, if we ask for <span class="math inline">\(F^{-1}(0.25)\)</span>, then it is not immediately clear what this means, as <span class="math inline">\(F(y) = 0.25\)</span> for all <span class="math inline">\(0 \leq y &lt; 1\)</span>.</p>
We define <span class="math inline">\(F^{-1}(.)\)</span> by the <em>quantile</em> function
<span class="math display" id="eq:quantile">\[\begin{equation}
F^{-1}(u) = \inf\{y \in \mathbb{R}: F(y) \geq u\},
\tag{7.1}
\end{equation}\]</span>
<p>for <span class="math inline">\(u \in (0, 1)\)</span>. In our example, we now have <span class="math inline">\(F^{-1}(0.25) = 0\)</span>. If <span class="math inline">\(F(.)\)</span> is an invertible function, then this definition agrees with the usual inverse we saw before.</p>
Equipped with this definition of <span class="math inline">\(F^{-1}(.)\)</span>, we may now rewrite Corollary <a href="unitransform.html#cor:inversetranscont">7.1</a> to apply to any distribution: 
<div class="corollary">
<span id="cor:unnamed-chunk-62" class="corollary"><strong>Corollary 7.2  </strong></span>Let <span class="math inline">\(F(.)\)</span> be a cumulative distribution function, and let <span class="math inline">\(F^{-1}(.)\)</span> be the corresponding quantile function, defined by <a href="unitransform.html#eq:quantile">(7.1)</a>. Suppose that <span class="math inline">\(U \sim U(0, 1)\)</span>. Then <span class="math inline">\(Y = F^{-1}(U)\)</span> has cumulative distribution function <span class="math inline">\(F(.)\)</span>.
</div>


<div class="example">
<span id="exm:unnamed-chunk-63" class="example"><strong>Example 7.5  (Generating a binomial random variable)  </strong></span>Suppose that you are given <span class="math inline">\(U \sim N(0, 1)\)</span>, and would like to generate <span class="math inline">\(Y \sim \text{binomial}(2, 0.5)\)</span>. The <span class="math inline">\(\text{binomial}(2)\)</span> distribution has cdf <span class="math display">\[F(y) = \begin{cases} 
0 &amp; \text{for $y &lt; 0$} \\
0.25 &amp; \text{for $0 \leq y &lt; 1$} \\
0.75 &amp; \text{for $1 \leq y &lt; 2$} \\
1 &amp; \text{for $y &gt; 1$.}
\end{cases}\]</span> The corresponding quantile function is <span class="math display">\[F^{-1}(u) = \begin{cases} 
-\infty &amp; \text{for $u \leq 0$} \\
0 &amp; \text{for $0 &lt; u \leq 0.25$} \\
1 &amp; \text{for $0.25 &lt; u \leq 0.75$} \\
2 &amp; \text{for $0.75 &lt; u \leq 1$} \\
\infty &amp; \text{for $u &gt; 1$.}
\end{cases}\]</span> So <span class="math inline">\(Y = F^{-1}(U) \sim \text{binomial}(2, 0.5)\)</span>.
</div>


</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gamma.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bivariate-distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/heogden/math2011/edit/master/08-uni_transformations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["MATH2011.pdf", "MATH2011.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
